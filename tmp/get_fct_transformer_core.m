function core = get_fct_transformer_core(core_id)

%% fct
fct_interp.N97 = get_N97();
fct_interp.N95 = get_N95();
fct_interp.N49 = get_N49();
P_fct = @(f, B_peak, T, id, n_sol) get_sub(fct_interp, f, B_peak, T, id, n_sol);

%% param
rho = get_integer_map([49 95 97], [4750 4900 4850], core_id);
kappa = get_integer_map([49 95 97], [12.5 9.5 7.5], core_id);

%% parameter
B_peak_max = 300e-3;
f_max = 1000e3;
P_scale = 1.3;
T_init = 80.0;
T_max = 130.0;

%% assign
core.rho = rho;
core.lambda = rho.*kappa;
core.P_fct = P_fct;
core.core_id = core_id;
core.B_peak_max = B_peak_max;
core.f_max = f_max;
core.P_scale = P_scale;
core.T_init = T_init;
core.T_max = T_max;

end

function fct_interp = get_N97()

f_vec = 1e3.*[5 15 25 50 100 200 300 500 700 1000];
B_peak_vec = 1e-3.*[13 25 50 100 200 300];
T_vec = [20 25 30 40 50 60 70 80 90 100 110 120 140];
P_mat(:,:,1) = [3.124e+01 1.781e+02 1.028e+03 4.891e+03 2.050e+04 5.051e+04; 1.026e+02 5.850e+02 3.376e+03 1.613e+04 6.913e+04 1.683e+05; 1.784e+02 1.017e+03 5.869e+03 2.810e+04 1.217e+05 2.946e+05; 3.722e+02 2.122e+03 1.224e+04 5.887e+04 2.588e+05 6.215e+05; 8.829e+02 5.033e+03 2.902e+04 1.379e+05 6.040e+05 1.449e+06; 2.047e+03 1.167e+04 6.733e+04 3.287e+05 1.483e+06 3.558e+06; 3.115e+03 1.776e+04 1.072e+05 5.451e+05 2.599e+06 6.237e+06; 7.292e+03 4.178e+04 2.398e+05 1.228e+06 5.929e+06 1.423e+07; 1.065e+04 6.502e+04 4.103e+05 2.135e+06 1.030e+07 2.473e+07; 2.781e+04 1.523e+05 8.564e+05 4.274e+06 2.063e+07 4.951e+07];
P_mat(:,:,2) = [2.794e+01 1.591e+02 9.204e+02 4.399e+03 1.873e+04 4.698e+04; 9.303e+01 5.298e+02 3.065e+03 1.475e+04 6.407e+04 1.584e+05; 1.627e+02 9.268e+02 5.362e+03 2.589e+04 1.135e+05 2.786e+05; 3.426e+02 1.951e+03 1.129e+04 5.482e+04 2.435e+05 5.916e+05; 8.165e+02 4.650e+03 2.687e+04 1.293e+05 5.745e+05 1.394e+06; 1.902e+03 1.083e+04 6.283e+04 3.112e+05 1.436e+06 3.485e+06; 2.975e+03 1.694e+04 1.018e+05 5.225e+05 2.521e+06 6.117e+06; 6.853e+03 3.978e+04 2.311e+05 1.201e+06 5.849e+06 1.419e+07; 1.166e+04 6.827e+04 4.030e+05 2.089e+06 1.017e+07 2.469e+07; 3.083e+04 1.610e+05 8.514e+05 4.230e+06 2.060e+07 4.999e+07];
P_mat(:,:,3) = [2.498e+01 1.421e+02 8.241e+02 3.957e+03 1.711e+04 4.370e+04; 8.433e+01 4.797e+02 2.782e+03 1.349e+04 5.938e+04 1.490e+05; 1.485e+02 8.447e+02 4.898e+03 2.386e+04 1.059e+05 2.635e+05; 3.154e+02 1.794e+03 1.040e+04 5.104e+04 2.291e+05 5.632e+05; 7.552e+02 4.296e+03 2.488e+04 1.212e+05 5.464e+05 1.341e+06; 1.766e+03 1.005e+04 5.861e+04 2.946e+05 1.391e+06 3.414e+06; 2.840e+03 1.616e+04 9.678e+04 5.008e+05 2.444e+06 5.999e+06; 6.425e+03 3.784e+04 2.227e+05 1.175e+06 5.770e+06 1.416e+07; 1.276e+04 7.167e+04 3.959e+05 2.045e+06 1.004e+07 2.465e+07; 3.412e+04 1.701e+05 8.465e+05 4.186e+06 2.056e+07 5.046e+07];
P_mat(:,:,4) = [2.048e+01 1.121e+02 6.508e+02 3.176e+03 1.417e+04 3.752e+04; 7.115e+01 3.895e+02 2.261e+03 1.116e+04 5.061e+04 1.311e+05; 1.270e+02 6.950e+02 4.035e+03 2.003e+04 9.149e+04 2.346e+05; 2.748e+02 1.504e+03 8.734e+03 4.371e+04 2.014e+05 5.086e+05; 6.641e+02 3.635e+03 2.108e+04 1.051e+05 4.903e+05 1.236e+06; 1.578e+03 8.636e+03 5.061e+04 2.614e+05 1.288e+06 3.245e+06; 2.666e+03 1.459e+04 8.650e+04 4.554e+05 2.271e+06 5.722e+06; 6.262e+03 3.586e+04 2.086e+05 1.113e+06 5.551e+06 1.399e+07; 1.454e+04 7.617e+04 3.832e+05 1.969e+06 9.821e+06 2.475e+07; 3.881e+04 1.821e+05 8.366e+05 4.076e+06 2.033e+07 5.123e+07];
P_mat(:,:,5) = [1.691e+01 8.708e+01 5.042e+02 2.504e+03 1.160e+04 3.196e+04; 6.055e+01 3.117e+02 1.805e+03 9.084e+03 4.273e+04 1.148e+05; 1.096e+02 5.640e+02 3.266e+03 1.654e+04 7.834e+04 2.079e+05; 2.418e+02 1.245e+03 7.208e+03 3.682e+04 1.757e+05 4.581e+05; 5.889e+02 3.032e+03 1.754e+04 8.975e+04 4.365e+05 1.136e+06; 1.438e+03 7.404e+03 4.330e+04 2.291e+05 1.175e+06 3.057e+06; 2.550e+03 1.313e+04 7.662e+04 4.099e+05 2.086e+06 5.427e+06; 6.593e+03 3.532e+04 1.960e+05 1.041e+06 5.274e+06 1.372e+07; 1.597e+04 7.863e+04 3.774e+05 1.911e+06 9.681e+06 2.518e+07; 4.148e+04 1.871e+05 8.314e+05 3.955e+06 2.004e+07 5.212e+07];
P_mat(:,:,6) = [1.385e+01 6.703e+01 3.853e+02 1.955e+03 9.431e+03 2.711e+04; 5.099e+01 2.468e+02 1.419e+03 7.300e+03 3.587e+04 1.003e+05; 9.348e+01 4.525e+02 2.601e+03 1.347e+04 6.676e+04 1.842e+05; 2.101e+02 1.017e+03 5.847e+03 3.054e+04 1.528e+05 4.132e+05; 5.154e+02 2.495e+03 1.435e+04 7.549e+04 3.871e+05 1.045e+06; 1.314e+03 6.359e+03 3.681e+04 1.990e+05 1.064e+06 2.872e+06; 2.455e+03 1.188e+04 6.768e+04 3.670e+05 1.911e+06 5.158e+06; 7.095e+03 3.540e+04 1.845e+05 9.664e+05 4.985e+06 1.345e+07; 1.687e+04 7.897e+04 3.719e+05 1.858e+06 9.583e+06 2.586e+07; 4.283e+04 1.878e+05 8.264e+05 3.822e+06 1.971e+07 5.320e+07];
P_mat(:,:,7) = [1.107e+01 5.082e+01 2.880e+02 1.505e+03 7.661e+03 2.304e+04; 4.210e+01 1.932e+02 1.095e+03 5.793e+03 3.015e+04 8.799e+04; 7.834e+01 3.594e+02 2.037e+03 1.084e+04 5.702e+04 1.641e+05; 1.797e+02 8.247e+02 4.674e+03 2.504e+04 1.333e+05 3.754e+05; 4.437e+02 2.036e+03 1.157e+04 6.286e+04 3.445e+05 9.675e+05; 1.200e+03 5.507e+03 3.124e+04 1.723e+05 9.638e+05 2.707e+06; 2.387e+03 1.095e+04 6.016e+04 3.294e+05 1.763e+06 4.952e+06; 7.609e+03 3.564e+04 1.743e+05 9.014e+05 4.761e+06 1.337e+07; 1.748e+04 7.851e+04 3.661e+05 1.786e+06 9.434e+06 2.650e+07; 4.312e+04 1.849e+05 8.117e+05 3.656e+06 1.931e+07 5.423e+07];
P_mat(:,:,8) = [8.543e+00 3.762e+01 2.092e+02 1.164e+03 6.309e+03 1.985e+04; 3.386e+01 1.491e+02 8.290e+02 4.606e+03 2.571e+04 7.828e+04; 6.423e+01 2.828e+02 1.573e+03 8.729e+03 4.941e+04 1.482e+05; 1.514e+02 6.669e+02 3.708e+03 2.049e+04 1.181e+05 3.460e+05; 3.758e+02 1.655e+03 9.249e+03 5.234e+04 3.107e+05 9.079e+05; 1.101e+03 4.850e+03 2.675e+04 1.504e+05 8.848e+05 2.585e+06; 2.353e+03 1.036e+04 5.442e+04 2.997e+05 1.660e+06 4.851e+06; 8.024e+03 3.580e+04 1.666e+05 8.540e+05 4.655e+06 1.360e+07; 1.795e+04 7.794e+04 3.572e+05 1.685e+06 9.186e+06 2.684e+07; 4.281e+04 1.804e+05 7.835e+05 3.460e+06 1.886e+07 5.510e+07];
P_mat(:,:,9) = [6.633e+00 2.840e+01 1.546e+02 9.216e+02 5.378e+03 1.759e+04; 2.731e+01 1.169e+02 6.366e+02 3.737e+03 2.265e+04 7.149e+04; 5.272e+01 2.258e+02 1.229e+03 7.165e+03 4.421e+04 1.372e+05; 1.273e+02 5.452e+02 2.968e+03 1.705e+04 1.079e+05 3.266e+05; 3.180e+02 1.362e+03 7.475e+03 4.442e+04 2.883e+05 8.697e+05; 1.025e+03 4.389e+03 2.344e+04 1.346e+05 8.360e+05 2.522e+06; 2.368e+03 1.014e+04 5.075e+04 2.804e+05 1.620e+06 4.888e+06; 8.306e+03 3.588e+04 1.624e+05 8.290e+05 4.707e+06 1.420e+07; 1.840e+04 7.808e+04 3.441e+05 1.577e+06 8.953e+06 2.701e+07; 4.240e+04 1.762e+05 7.433e+05 3.283e+06 1.864e+07 5.623e+07];
P_mat(:,:,10) = [5.173e+00 2.183e+01 1.167e+02 7.779e+02 4.886e+03 1.632e+04; 2.231e+01 9.414e+01 5.030e+02 3.212e+03 2.112e+04 6.794e+04; 4.401e+01 1.857e+02 9.924e+02 6.209e+03 4.170e+04 1.319e+05; 1.095e+02 4.620e+02 2.468e+03 1.491e+04 1.035e+05 3.187e+05; 2.761e+02 1.165e+03 6.300e+03 3.959e+04 2.793e+05 8.570e+05; 9.833e+02 4.150e+03 2.146e+04 1.261e+05 8.271e+05 2.538e+06; 2.445e+03 1.032e+04 4.940e+04 2.736e+05 1.660e+06 5.094e+06; 8.479e+03 3.605e+04 1.623e+05 8.274e+05 4.932e+06 1.513e+07; 1.888e+04 7.917e+04 3.317e+05 1.531e+06 9.127e+06 2.800e+07; 4.259e+04 1.752e+05 7.137e+05 3.239e+06 1.931e+07 5.924e+07];
P_mat(:,:,11) = [4.332e+00 1.821e+01 9.655e+01 7.281e+02 4.841e+03 1.610e+04; 1.946e+01 8.183e+01 4.339e+02 3.035e+03 2.121e+04 6.796e+04; 3.915e+01 1.646e+02 8.725e+02 5.895e+03 4.217e+04 1.327e+05; 9.991e+01 4.201e+02 2.227e+03 1.421e+04 1.056e+05 3.236e+05; 2.556e+02 1.075e+03 5.783e+03 3.834e+04 2.861e+05 8.735e+05; 9.856e+02 4.144e+03 2.098e+04 1.263e+05 8.679e+05 2.650e+06; 2.589e+03 1.089e+04 5.058e+04 2.818e+05 1.797e+06 5.486e+06; 8.661e+03 3.669e+04 1.651e+05 8.459e+05 5.306e+06 1.620e+07; 1.937e+04 8.096e+04 3.394e+05 1.633e+06 1.024e+07 3.128e+07; 4.434e+04 1.814e+05 7.390e+05 3.483e+06 2.185e+07 6.671e+07];
P_mat(:,:,12) = [4.142e+00 1.751e+01 9.510e+01 7.749e+02 5.260e+03 1.700e+04; 1.891e+01 7.995e+01 4.341e+02 3.234e+03 2.308e+04 7.189e+04; 3.830e+01 1.620e+02 8.794e+02 6.283e+03 4.590e+04 1.405e+05; 9.858e+01 4.169e+02 2.264e+03 1.514e+04 1.150e+05 3.429e+05; 2.549e+02 1.078e+03 5.973e+03 4.114e+04 3.109e+05 9.238e+05; 1.032e+03 4.366e+03 2.216e+04 1.366e+05 9.679e+05 2.876e+06; 2.793e+03 1.181e+04 5.444e+04 3.073e+05 2.049e+06 6.086e+06; 9.013e+03 3.847e+04 1.734e+05 8.993e+05 5.915e+06 1.757e+07; 2.025e+04 8.510e+04 3.739e+05 1.862e+06 1.225e+07 3.639e+07; 4.807e+04 1.965e+05 8.261e+05 3.996e+06 2.628e+07 7.808e+07];
P_mat(:,:,13) = [4.886e+00 2.090e+01 1.273e+02 1.102e+03 7.140e+03 2.181e+04; 2.302e+01 9.847e+01 5.997e+02 4.608e+03 3.140e+04 9.251e+04; 4.732e+01 2.024e+02 1.233e+03 8.963e+03 6.253e+04 1.811e+05; 1.239e+02 5.299e+02 3.227e+03 2.157e+04 1.568e+05 4.426e+05; 3.272e+02 1.400e+03 8.791e+03 5.947e+04 4.222e+05 1.188e+06; 1.461e+03 6.251e+03 3.413e+04 2.007e+05 1.384e+06 3.892e+06; 4.194e+03 1.794e+04 8.702e+04 4.588e+05 3.062e+06 8.612e+06; 1.260e+04 5.461e+04 2.639e+05 1.275e+06 8.441e+06 2.374e+07; 2.853e+04 1.212e+05 6.256e+05 3.040e+06 2.013e+07 5.661e+07; 7.278e+04 2.969e+05 1.425e+06 6.595e+06 4.366e+07 1.228e+08];

fct_interp = get_fct_interp(f_vec, B_peak_vec, T_vec, P_mat);

end

function fct_interp = get_N49()

f_vec = 1e3.*[5 15 25 50 100 200 300 500 700 1000];
B_peak_vec = 1e-3.*[13 25 50 100 200 300];
T_vec = [20 25 30 40 50 60 70 80 90 100 110 120 140];
P_mat(:,:,1) = [1.058e+01 6.002e+01 3.642e+02 2.413e+03 2.381e+04 7.700e+04; 4.608e+01 2.614e+02 1.586e+03 9.835e+03 7.818e+04 2.479e+05; 9.135e+01 5.182e+02 3.145e+03 1.890e+04 1.359e+05 4.271e+05; 2.361e+02 1.339e+03 8.128e+03 4.642e+04 2.856e+05 8.852e+05; 5.286e+02 2.999e+03 1.806e+04 1.047e+05 6.386e+05 1.977e+06; 1.007e+03 5.712e+03 3.702e+04 2.202e+05 1.460e+06 4.519e+06; 1.593e+03 9.036e+03 5.677e+04 3.440e+05 2.356e+06 7.293e+06; 3.054e+03 1.736e+04 1.080e+05 6.796e+05 4.674e+06 1.447e+07; 4.819e+03 2.795e+04 1.676e+05 1.117e+06 7.682e+06 2.378e+07; 9.894e+03 5.465e+04 3.250e+05 2.066e+06 1.421e+07 4.398e+07];
P_mat(:,:,2) = [1.189e+01 6.874e+01 4.351e+02 2.717e+03 2.280e+04 7.284e+04; 4.557e+01 2.635e+02 1.668e+03 1.021e+04 7.491e+04 2.365e+05; 8.512e+01 4.921e+02 3.115e+03 1.888e+04 1.302e+05 4.089e+05; 2.012e+02 1.163e+03 7.362e+03 4.380e+04 2.742e+05 8.535e+05; 4.326e+02 2.501e+03 1.577e+04 9.699e+04 6.052e+05 1.882e+06; 8.719e+02 5.041e+03 3.309e+04 2.062e+05 1.395e+06 4.338e+06; 1.374e+03 7.945e+03 5.094e+04 3.229e+05 2.272e+06 7.067e+06; 2.613e+03 1.522e+04 9.618e+04 6.281e+05 4.444e+06 1.382e+07; 4.143e+03 2.424e+04 1.468e+05 1.022e+06 7.235e+06 2.250e+07; 9.032e+03 4.976e+04 2.954e+05 1.945e+06 1.376e+07 4.281e+07];
P_mat(:,:,3) = [1.334e+01 7.858e+01 5.187e+02 3.057e+03 2.183e+04 6.890e+04; 4.498e+01 2.650e+02 1.750e+03 1.058e+04 7.176e+04 2.255e+05; 7.916e+01 4.664e+02 3.079e+03 1.885e+04 1.248e+05 3.914e+05; 1.713e+02 1.009e+03 6.662e+03 4.131e+04 2.632e+05 8.230e+05; 3.540e+02 2.086e+03 1.376e+04 8.988e+04 5.735e+05 1.793e+06; 7.549e+02 4.447e+03 2.957e+04 1.931e+05 1.333e+06 4.165e+06; 1.186e+03 6.985e+03 4.571e+04 3.031e+05 2.191e+06 6.849e+06; 2.235e+03 1.335e+04 8.568e+04 5.804e+05 4.226e+06 1.321e+07; 3.555e+03 2.099e+04 1.284e+05 9.356e+05 6.811e+06 2.129e+07; 8.224e+03 4.520e+04 2.681e+05 1.829e+06 1.332e+07 4.163e+07];
P_mat(:,:,4) = [1.091e+01 6.126e+01 3.871e+02 2.642e+03 1.943e+04 6.271e+04; 3.858e+01 2.166e+02 1.368e+03 9.174e+03 6.489e+04 2.087e+05; 6.940e+01 3.896e+02 2.461e+03 1.637e+04 1.137e+05 3.650e+05; 1.553e+02 8.719e+02 5.509e+03 3.595e+04 2.421e+05 7.754e+05; 3.226e+02 1.811e+03 1.137e+04 7.800e+04 5.326e+05 1.705e+06; 6.502e+02 3.650e+03 2.429e+04 1.669e+05 1.248e+06 3.995e+06; 1.028e+03 5.768e+03 3.748e+04 2.613e+05 2.057e+06 6.586e+06; 2.017e+03 1.143e+04 7.175e+04 5.145e+05 4.083e+06 1.307e+07; 3.167e+03 1.830e+04 1.099e+05 8.438e+05 6.696e+06 2.144e+07; 8.060e+03 4.301e+04 2.465e+05 1.707e+06 1.354e+07 4.337e+07];
P_mat(:,:,5) = [9.211e+00 5.049e+01 3.304e+02 2.268e+03 1.774e+04 5.852e+04; 3.274e+01 1.795e+02 1.174e+03 8.040e+03 6.038e+04 1.977e+05; 5.904e+01 3.236e+02 2.118e+03 1.448e+04 1.067e+05 3.482e+05; 1.331e+02 7.298e+02 4.776e+03 3.235e+04 2.302e+05 7.473e+05; 2.665e+02 1.461e+03 9.542e+03 6.900e+04 5.083e+05 1.649e+06; 5.561e+02 3.048e+03 2.044e+04 1.472e+05 1.200e+06 3.892e+06; 8.936e+02 4.898e+03 3.135e+04 2.302e+05 2.001e+06 6.493e+06; 1.802e+03 1.004e+04 6.176e+04 4.635e+05 4.074e+06 1.322e+07; 2.994e+03 1.677e+04 9.865e+04 7.842e+05 6.893e+06 2.236e+07; 8.297e+03 4.245e+04 2.346e+05 1.642e+06 1.443e+07 4.682e+07];
P_mat(:,:,6) = [8.236e+00 4.352e+01 2.793e+02 2.064e+03 1.702e+04 5.592e+04; 3.011e+01 1.591e+02 1.021e+03 7.388e+03 5.870e+04 1.925e+05; 5.501e+01 2.907e+02 1.866e+03 1.337e+04 1.044e+05 3.421e+05; 1.267e+02 6.694e+02 4.296e+03 3.006e+04 2.269e+05 7.431e+05; 2.523e+02 1.333e+03 8.540e+03 6.433e+04 5.066e+05 1.658e+06; 5.241e+02 2.769e+03 1.823e+04 1.365e+05 1.206e+06 3.948e+06; 8.288e+02 4.380e+03 2.762e+04 2.126e+05 2.064e+06 6.756e+06; 1.726e+03 9.227e+03 5.586e+04 4.374e+05 4.322e+06 1.415e+07; 2.998e+03 1.645e+04 9.324e+04 7.549e+05 7.459e+06 2.442e+07; 8.606e+03 4.309e+04 2.297e+05 1.625e+06 1.606e+07 5.257e+07];
P_mat(:,:,7) = [1.173e+01 6.199e+01 3.885e+02 2.191e+03 1.745e+04 5.702e+04; 3.562e+01 1.882e+02 1.180e+03 7.578e+03 6.031e+04 1.968e+05; 5.969e+01 3.154e+02 1.977e+03 1.349e+04 1.074e+05 3.501e+05; 1.200e+02 6.342e+02 3.975e+03 2.959e+04 2.335e+05 7.603e+05; 2.456e+02 1.298e+03 8.110e+03 6.370e+04 5.267e+05 1.715e+06; 5.144e+02 2.718e+03 1.751e+04 1.358e+05 1.275e+06 4.150e+06; 7.920e+02 4.185e+03 2.644e+04 2.116e+05 2.317e+06 7.544e+06; 1.674e+03 9.050e+03 5.426e+04 4.400e+05 4.974e+06 1.620e+07; 3.134e+03 1.672e+04 9.277e+04 7.652e+05 8.651e+06 2.817e+07; 9.103e+03 4.408e+04 2.317e+05 1.686e+06 1.906e+07 6.205e+07];
P_mat(:,:,8) = [1.031e+01 5.175e+01 3.271e+02 2.250e+03 1.836e+04 5.967e+04; 3.420e+01 1.716e+02 1.085e+03 7.874e+03 6.403e+04 2.070e+05; 5.971e+01 2.996e+02 1.894e+03 1.410e+04 1.145e+05 3.690e+05; 1.276e+02 6.402e+02 4.047e+03 3.113e+04 2.499e+05 8.027e+05; 2.644e+02 1.327e+03 8.361e+03 6.762e+04 5.707e+05 1.832e+06; 5.519e+02 2.769e+03 1.803e+04 1.453e+05 1.398e+06 4.488e+06; 8.659e+02 4.344e+03 2.745e+04 2.275e+05 2.856e+06 9.170e+06; 1.866e+03 9.403e+03 5.655e+04 4.752e+05 6.335e+06 2.034e+07; 3.278e+03 1.718e+04 9.602e+04 8.043e+05 1.072e+07 3.443e+07; 9.291e+03 4.536e+04 2.409e+05 1.849e+06 2.465e+07 7.913e+07];
P_mat(:,:,9) = [9.759e+00 5.168e+01 3.564e+02 2.484e+03 1.985e+04 6.437e+04; 3.253e+01 1.723e+02 1.188e+03 8.717e+03 6.987e+04 2.233e+05; 5.694e+01 3.015e+02 2.079e+03 1.563e+04 1.254e+05 3.981e+05; 1.223e+02 6.477e+02 4.466e+03 3.456e+04 2.752e+05 8.649e+05; 2.492e+02 1.320e+03 9.135e+03 7.535e+04 6.323e+05 1.985e+06; 5.444e+02 2.883e+03 1.957e+04 1.634e+05 1.502e+06 4.713e+06; 8.948e+02 4.739e+03 3.042e+04 2.591e+05 4.128e+06 1.296e+07; 1.870e+03 1.012e+04 6.214e+04 5.460e+05 1.002e+07 3.145e+07; 3.423e+03 1.825e+04 1.051e+05 9.097e+05 1.669e+07 5.240e+07; 9.977e+03 4.863e+04 2.642e+05 2.143e+06 3.932e+07 1.234e+08];
P_mat(:,:,10) = [1.371e+01 7.315e+01 4.920e+02 2.933e+03 2.202e+04 6.848e+04; 4.112e+01 2.195e+02 1.476e+03 1.006e+04 7.736e+04 2.399e+05; 6.853e+01 3.658e+02 2.460e+03 1.784e+04 1.388e+05 4.296e+05; 1.364e+02 7.281e+02 4.897e+03 3.873e+04 3.037e+05 9.384e+05; 2.830e+02 1.510e+03 1.013e+04 8.570e+04 7.021e+05 2.169e+06; 5.951e+02 3.176e+03 2.209e+04 1.899e+05 1.657e+06 5.118e+06; 9.876e+02 5.271e+03 3.464e+04 3.033e+05 5.353e+06 1.653e+07; 2.022e+03 1.102e+04 6.994e+04 6.436e+05 1.372e+07 4.238e+07; 3.727e+03 2.008e+04 1.202e+05 1.099e+06 2.342e+07 7.235e+07; 1.103e+04 5.429e+04 3.026e+05 2.560e+06 5.457e+07 1.685e+08];
P_mat(:,:,11) = [1.350e+01 7.346e+01 4.913e+02 2.984e+03 2.397e+04 7.370e+04; 4.347e+01 2.365e+02 1.582e+03 1.076e+04 8.476e+04 2.571e+05; 7.486e+01 4.072e+02 2.724e+03 1.954e+04 1.525e+05 4.597e+05; 1.572e+02 8.551e+02 5.719e+03 4.392e+04 3.352e+05 1.001e+06; 3.154e+02 1.716e+03 1.143e+04 9.818e+04 7.744e+05 2.310e+06; 6.599e+02 3.590e+03 2.504e+04 2.226e+05 1.869e+06 5.575e+06; 1.084e+03 5.897e+03 3.954e+04 3.588e+05 5.747e+06 1.714e+07; 2.175e+03 1.213e+04 7.917e+04 7.758e+05 1.477e+07 4.408e+07; 4.149e+03 2.277e+04 1.403e+05 1.372e+06 2.613e+07 7.797e+07; 1.264e+04 6.278e+04 3.552e+05 3.084e+06 5.874e+07 1.752e+08];
P_mat(:,:,12) = [1.401e+01 7.628e+01 5.263e+02 3.447e+03 2.594e+04 7.751e+04; 4.534e+01 2.468e+02 1.703e+03 1.225e+04 9.182e+04 2.699e+05; 7.827e+01 4.260e+02 2.939e+03 2.208e+04 1.653e+05 4.820e+05; 1.642e+02 8.939e+02 6.167e+03 4.896e+04 3.634e+05 1.048e+06; 3.425e+02 1.864e+03 1.281e+04 1.111e+05 8.413e+05 2.423e+06; 7.255e+02 3.949e+03 2.835e+04 2.594e+05 2.073e+06 5.971e+06; 1.197e+03 6.513e+03 4.511e+04 4.263e+05 5.981e+06 1.723e+07; 2.415e+03 1.343e+04 9.089e+04 8.923e+05 1.452e+07 4.181e+07; 4.502e+03 2.517e+04 1.608e+05 1.784e+06 2.902e+07 8.357e+07; 1.433e+04 7.180e+04 4.116e+05 3.828e+06 6.227e+07 1.793e+08];
P_mat(:,:,13) = [1.948e+01 1.061e+02 8.334e+02 5.777e+03 3.493e+04 9.856e+04; 6.367e+01 3.469e+02 2.724e+03 1.990e+04 1.239e+05 3.418e+05; 1.104e+02 6.018e+02 4.725e+03 3.538e+04 2.232e+05 6.095e+05; 2.312e+02 1.260e+03 9.893e+03 7.639e+04 4.912e+05 1.321e+06; 5.210e+02 2.839e+03 2.220e+04 1.785e+05 1.142e+06 3.064e+06; 1.132e+03 6.166e+03 5.015e+04 4.419e+05 2.932e+06 7.869e+06; 1.882e+03 1.025e+04 8.102e+04 7.558e+05 7.437e+06 1.996e+07; 3.843e+03 2.128e+04 1.653e+05 1.480e+06 1.609e+07 4.319e+07; 6.831e+03 3.966e+04 2.912e+05 3.780e+06 4.111e+07 1.103e+08; 2.367e+04 1.210e+05 7.622e+05 7.187e+06 7.816e+07 2.097e+08];

fct_interp = get_fct_interp(f_vec, B_peak_vec, T_vec, P_mat);

end

function fct_interp = get_N95()

f_vec = 1e3.*[5 15 25 50 100 200 300 500 700 1000];
B_peak_vec = 1e-3.*[13 25 50 100 200 300];
T_vec = [20 25 30 40 50 60 70 80 90 100 110 120 140];
P_mat(:,:,1) = [1.449e+01 6.603e+01 3.061e+02 1.627e+03 7.029e+03 1.678e+04; 5.724e+01 2.608e+02 1.209e+03 6.288e+03 2.913e+04 7.255e+04; 1.084e+02 4.941e+02 2.290e+03 1.179e+04 5.641e+04 1.433e+05; 2.578e+02 1.175e+03 5.444e+03 2.755e+04 1.374e+05 3.599e+05; 6.088e+02 2.774e+03 1.264e+04 6.494e+04 3.443e+05 9.054e+05; 1.534e+03 6.992e+03 3.542e+04 1.799e+05 9.856e+05 2.591e+06; 2.712e+03 1.236e+04 6.692e+04 3.513e+05 1.881e+06 4.946e+06; 7.798e+03 3.583e+04 1.848e+05 8.670e+05 4.608e+06 1.211e+07; 2.077e+04 9.234e+04 4.372e+05 2.555e+06 1.358e+07 3.569e+07; 4.256e+04 1.908e+05 8.469e+05 3.459e+06 1.838e+07 4.832e+07];
P_mat(:,:,2) = [1.320e+01 6.015e+01 2.785e+02 1.499e+03 6.864e+03 1.668e+04; 5.341e+01 2.434e+02 1.127e+03 5.918e+03 2.842e+04 7.194e+04; 1.023e+02 4.664e+02 2.160e+03 1.121e+04 5.502e+04 1.419e+05; 2.469e+02 1.126e+03 5.212e+03 2.652e+04 1.339e+05 3.556e+05; 5.946e+02 2.710e+03 1.234e+04 6.370e+04 3.339e+05 8.898e+05; 1.493e+03 6.804e+03 3.451e+04 1.767e+05 9.854e+05 2.626e+06; 2.696e+03 1.229e+04 6.536e+04 3.445e+05 1.853e+06 4.937e+06; 7.792e+03 3.587e+04 1.836e+05 8.619e+05 4.573e+06 1.219e+07; 2.087e+04 9.286e+04 4.366e+05 2.556e+06 1.356e+07 3.614e+07; 4.296e+04 1.912e+05 8.461e+05 3.422e+06 1.815e+07 4.838e+07];
P_mat(:,:,3) = [1.201e+01 5.479e+01 2.535e+02 1.381e+03 6.704e+03 1.659e+04; 4.982e+01 2.272e+02 1.051e+03 5.570e+03 2.773e+04 7.132e+04; 9.653e+01 4.402e+02 2.036e+03 1.065e+04 5.366e+04 1.405e+05; 2.365e+02 1.079e+03 4.990e+03 2.553e+04 1.305e+05 3.514e+05; 5.806e+02 2.648e+03 1.205e+04 6.249e+04 3.237e+05 8.745e+05; 1.452e+03 6.620e+03 3.362e+04 1.734e+05 9.852e+05 2.661e+06; 2.679e+03 1.221e+04 6.384e+04 3.378e+05 1.824e+06 4.928e+06; 7.786e+03 3.592e+04 1.825e+05 8.568e+05 4.538e+06 1.226e+07; 2.097e+04 9.338e+04 4.360e+05 2.557e+06 1.354e+07 3.659e+07; 4.337e+04 1.916e+05 8.454e+05 3.384e+06 1.793e+07 4.843e+07];
P_mat(:,:,4) = [9.900e+00 4.469e+01 2.035e+02 1.221e+03 6.205e+03 1.571e+04; 4.238e+01 1.913e+02 8.712e+02 4.958e+03 2.600e+04 6.856e+04; 8.332e+01 3.761e+02 1.713e+03 9.512e+03 5.063e+04 1.360e+05; 2.088e+02 9.423e+02 4.292e+03 2.291e+04 1.241e+05 3.432e+05; 5.129e+02 2.315e+03 1.033e+04 5.572e+04 3.117e+05 8.654e+05; 1.304e+03 5.884e+03 3.026e+04 1.617e+05 9.619e+05 2.671e+06; 2.602e+03 1.174e+04 5.982e+04 3.203e+05 1.797e+06 4.990e+06; 7.761e+03 3.545e+04 1.765e+05 8.260e+05 4.543e+06 1.261e+07; 2.102e+04 9.231e+04 4.276e+05 2.523e+06 1.388e+07 3.854e+07; 4.384e+04 1.919e+05 8.384e+05 3.343e+06 1.839e+07 5.106e+07];
P_mat(:,:,5) = [8.947e+00 3.980e+01 1.817e+02 1.046e+03 5.426e+03 1.488e+04; 3.777e+01 1.680e+02 7.673e+02 4.343e+03 2.370e+04 6.591e+04; 7.379e+01 3.282e+02 1.499e+03 8.420e+03 4.704e+04 1.317e+05; 1.826e+02 8.122e+02 3.709e+03 2.060e+04 1.187e+05 3.356e+05; 4.524e+02 2.012e+03 9.003e+03 5.007e+04 2.997e+05 8.480e+05; 1.201e+03 5.340e+03 2.752e+04 1.498e+05 9.279e+05 2.626e+06; 2.526e+03 1.124e+04 5.634e+04 3.014e+05 1.741e+06 4.926e+06; 7.799e+03 3.501e+04 1.723e+05 7.998e+05 4.518e+06 1.279e+07; 2.083e+04 9.003e+04 4.165e+05 2.494e+06 1.409e+07 3.988e+07; 4.372e+04 1.911e+05 8.251e+05 3.331e+06 1.882e+07 5.326e+07];
P_mat(:,:,6) = [8.104e+00 3.546e+01 1.592e+02 9.599e+02 5.043e+03 1.362e+04; 3.415e+01 1.494e+02 6.709e+02 3.958e+03 2.233e+04 6.212e+04; 6.666e+01 2.917e+02 1.310e+03 7.649e+03 4.461e+04 1.258e+05; 1.646e+02 7.201e+02 3.233e+03 1.857e+04 1.135e+05 3.267e+05; 4.078e+02 1.784e+03 7.840e+03 4.573e+04 2.915e+05 8.415e+05; 1.124e+03 4.918e+03 2.497e+04 1.388e+05 8.816e+05 2.545e+06; 2.438e+03 1.067e+04 5.303e+04 2.866e+05 1.746e+06 5.040e+06; 7.863e+03 3.475e+04 1.683e+05 7.723e+05 4.651e+06 1.343e+07; 2.085e+04 8.781e+04 4.039e+05 2.496e+06 1.503e+07 4.340e+07; 4.360e+04 1.883e+05 8.066e+05 3.328e+06 2.004e+07 5.786e+07];
P_mat(:,:,7) = [7.002e+00 3.021e+01 1.342e+02 8.637e+02 4.574e+03 1.169e+04; 3.008e+01 1.298e+02 5.763e+02 3.587e+03 2.087e+04 5.699e+04; 5.923e+01 2.555e+02 1.135e+03 6.954e+03 4.228e+04 1.190e+05; 1.486e+02 6.410e+02 2.847e+03 1.698e+04 1.098e+05 3.244e+05; 3.593e+02 1.550e+03 6.735e+03 4.152e+04 2.835e+05 8.426e+05; 1.052e+03 4.540e+03 2.272e+04 1.290e+05 8.668e+05 2.576e+06; 2.326e+03 1.003e+04 5.001e+04 2.718e+05 1.713e+06 5.092e+06; 7.868e+03 3.422e+04 1.632e+05 7.584e+05 4.698e+06 1.396e+07; 2.063e+04 8.621e+04 3.918e+05 2.506e+06 1.552e+07 4.613e+07; 4.314e+04 1.843e+05 7.870e+05 3.375e+06 2.090e+07 6.213e+07];
P_mat(:,:,8) = [6.298e+00 2.697e+01 1.254e+02 7.771e+02 4.097e+03 1.077e+04; 2.644e+01 1.132e+02 5.263e+02 3.285e+03 1.958e+04 5.441e+04; 5.152e+01 2.206e+02 1.026e+03 6.421e+03 4.052e+04 1.156e+05; 1.263e+02 5.407e+02 2.514e+03 1.581e+04 1.087e+05 3.228e+05; 3.161e+02 1.353e+03 6.196e+03 3.973e+04 2.842e+05 8.485e+05; 9.768e+02 4.183e+03 2.123e+04 1.257e+05 8.558e+05 2.555e+06; 2.292e+03 9.816e+03 4.815e+04 2.736e+05 1.808e+06 5.399e+06; 7.815e+03 3.371e+04 1.630e+05 7.214e+05 4.744e+06 1.416e+07; 2.050e+04 8.566e+04 3.899e+05 2.678e+06 1.761e+07 5.257e+07; 4.328e+04 1.829e+05 7.798e+05 3.648e+06 2.399e+07 7.160e+07];
P_mat(:,:,9) = [6.044e+00 2.566e+01 1.181e+02 7.340e+02 4.244e+03 1.116e+04; 2.526e+01 1.072e+02 4.936e+02 3.146e+03 2.004e+04 5.604e+04; 4.912e+01 2.085e+02 9.598e+02 6.188e+03 4.124e+04 1.187e+05; 1.196e+02 5.076e+02 2.336e+03 1.534e+04 1.097e+05 3.302e+05; 3.065e+02 1.301e+03 5.877e+03 3.938e+04 2.834e+05 8.576e+05; 9.507e+02 4.036e+03 2.060e+04 1.252e+05 8.589e+05 2.600e+06; 2.332e+03 9.902e+03 4.902e+04 2.807e+05 2.136e+06 6.464e+06; 7.938e+03 3.383e+04 1.622e+05 7.140e+05 5.622e+06 1.701e+07; 2.083e+04 8.690e+04 3.948e+05 2.937e+06 2.312e+07 6.998e+07; 4.419e+04 1.870e+05 7.941e+05 3.983e+06 3.136e+07 9.492e+07];
P_mat(:,:,10) = [5.807e+00 2.462e+01 1.159e+02 7.539e+02 4.141e+03 1.114e+04; 2.426e+01 1.029e+02 4.840e+02 3.223e+03 2.026e+04 5.695e+04; 4.716e+01 2.000e+02 9.409e+02 6.333e+03 4.239e+04 1.216e+05; 1.141e+02 4.836e+02 2.276e+03 1.563e+04 1.154e+05 3.417e+05; 3.021e+02 1.281e+03 5.951e+03 4.074e+04 3.033e+05 9.020e+05; 9.907e+02 4.201e+03 2.123e+04 1.306e+05 9.160e+05 2.724e+06; 2.479e+03 1.051e+04 5.133e+04 2.973e+05 2.676e+06 7.957e+06; 8.187e+03 3.487e+04 1.708e+05 7.454e+05 7.270e+06 2.162e+07; 2.167e+04 8.927e+04 4.117e+05 3.250e+06 3.169e+07 9.425e+07; 4.534e+04 1.928e+05 8.228e+05 4.501e+06 4.389e+07 1.305e+08];
P_mat(:,:,11) = [6.288e+00 2.695e+01 1.231e+02 8.182e+02 4.524e+03 1.204e+04; 2.639e+01 1.131e+02 5.167e+02 3.494e+03 2.199e+04 6.097e+04; 5.140e+01 2.203e+02 1.007e+03 6.864e+03 4.586e+04 1.296e+05; 1.251e+02 5.362e+02 2.450e+03 1.698e+04 1.241e+05 3.615e+05; 3.255e+02 1.395e+03 6.256e+03 4.328e+04 3.241e+05 9.476e+05; 1.036e+03 4.442e+03 2.246e+04 1.400e+05 1.009e+06 2.952e+06; 2.711e+03 1.162e+04 5.713e+04 3.328e+05 3.486e+06 1.019e+07; 8.820e+03 3.817e+04 1.807e+05 7.821e+05 9.207e+06 2.692e+07; 2.322e+04 9.667e+04 4.478e+05 3.627e+06 4.269e+07 1.248e+08; 4.882e+04 2.051e+05 8.848e+05 5.153e+06 6.065e+07 1.773e+08];
P_mat(:,:,12) = [6.417e+00 2.716e+01 1.223e+02 8.729e+02 4.772e+03 1.290e+04; 2.811e+01 1.190e+02 5.358e+02 3.791e+03 2.353e+04 6.505e+04; 5.588e+01 2.365e+02 1.065e+03 7.504e+03 4.940e+04 1.380e+05; 1.403e+02 5.940e+02 2.675e+03 1.880e+04 1.349e+05 3.830e+05; 3.656e+02 1.548e+03 6.816e+03 4.768e+04 3.478e+05 9.898e+05; 1.134e+03 4.799e+03 2.436e+04 1.530e+05 1.229e+06 3.498e+06; 3.302e+03 1.398e+04 6.792e+04 3.988e+05 4.557e+06 1.297e+07; 1.002e+04 4.264e+04 2.041e+05 8.713e+05 1.098e+07 3.123e+07; 2.550e+04 1.051e+05 4.862e+05 3.996e+06 5.035e+07 1.433e+08; 5.229e+04 2.211e+05 9.467e+05 6.042e+06 7.612e+07 2.166e+08];
P_mat(:,:,13) = [8.621e+00 3.560e+01 1.664e+02 1.247e+03 6.105e+03 1.704e+04; 4.117e+01 1.700e+02 7.947e+02 5.601e+03 3.097e+04 8.514e+04; 8.517e+01 3.517e+02 1.644e+03 1.126e+04 6.590e+04 1.799e+05; 2.279e+02 9.409e+02 4.399e+03 2.894e+04 1.831e+05 4.943e+05; 5.953e+02 2.458e+03 1.117e+04 7.265e+04 4.593e+05 1.238e+06; 1.749e+03 7.223e+03 3.951e+04 2.292e+05 2.090e+06 5.632e+06; 6.323e+03 2.611e+04 1.325e+05 7.185e+05 8.946e+06 2.411e+07; 1.665e+04 6.850e+04 3.584e+05 1.357e+06 1.793e+07 4.832e+07; 3.968e+04 1.603e+05 7.907e+05 6.083e+06 8.038e+07 2.166e+08; 7.728e+04 3.318e+05 1.495e+06 1.033e+07 1.365e+08 3.678e+08];

fct_interp = get_fct_interp(f_vec, B_peak_vec, T_vec, P_mat);

end

function fct_interp = get_fct_interp(f_vec, B_peak_vec, T_vec, P_mat)

[f_mat, B_peak_mat, T_mat] = ndgrid(f_vec, B_peak_vec, T_vec);
fct_interp = griddedInterpolant(log10(f_mat), log10(B_peak_mat), T_mat, log10(P_mat), 'makima', 'none');

end

function [P, is_valid] = get_sub(fct_interp, f, B_peak, T, id, n_sol)

% test
assert(length(f)==n_sol, 'invalid data')
assert(length(B_peak)==n_sol, 'invalid data')
assert(length(T)==n_sol, 'invalid data')
assert(length(id)==n_sol, 'invalid data')

% init
P = NaN(1, n_sol);

% N49
id_tmp = id==49;
P_tmp = get_sub_sub(fct_interp.N49, f, B_peak, T, id_tmp);
P(id_tmp) = P_tmp;

% N97
id_tmp = id==97;
P_tmp = get_sub_sub(fct_interp.N97, f, B_peak, T, id_tmp);
P(id_tmp) = P_tmp;

% N95
id_tmp = id==95;
P_tmp = get_sub_sub(fct_interp.N95, f, B_peak, T, id_tmp);
P(id_tmp) = P_tmp;

% valid
is_valid = isfinite(P);

end

function P = get_sub_sub(fct_interp, f, B_peak, T, id)

f = f(id);
B_peak = B_peak(id);
T = T(id);

P = 10.^fct_interp(log10(f), log10(B_peak), T);

end
